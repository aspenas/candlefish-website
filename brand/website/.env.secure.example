# ============================================
# CANDLEFISH.AI SECURITY DASHBOARD ENVIRONMENT VARIABLES
# ============================================
# SECURITY LEVEL: CRITICAL
# 
# This file contains all environment variable templates for the Security Dashboard.
# Copy this file to .env.local and populate with actual values from AWS Secrets Manager.
# 
# AWS Account: 681214184463
# Region: us-east-1
# ============================================

# --------------------------------------------
# APPLICATION CONFIGURATION
# --------------------------------------------
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://security.candlefish.ai
NEXT_PUBLIC_API_URL=https://api.candlefish.ai
PORT=3000

# --------------------------------------------
# AWS CONFIGURATION
# --------------------------------------------
# These are automatically configured in production via IAM roles
AWS_REGION=us-east-1
AWS_ACCOUNT_ID=681214184463
# AWS_ACCESS_KEY_ID=(Retrieved from IAM role)
# AWS_SECRET_ACCESS_KEY=(Retrieved from IAM role)

# --------------------------------------------
# AUTHENTICATION & JWT
# --------------------------------------------
# JWT configuration - keys stored in AWS Secrets Manager
JWT_ISSUER=https://api.candlefish.ai
JWT_AUDIENCE=candlefish-security-dashboard
JWKS_URI=https://paintbox.fly.dev/.well-known/jwks.json
TOKEN_EXPIRY=24h
REFRESH_TOKEN_EXPIRY=7d

# Session configuration
SESSION_SECRET=(Retrieved from: candlefish/session/secret)
SESSION_MAX_AGE=86400
COOKIE_SECURE=true
COOKIE_HTTPONLY=true
COOKIE_SAMESITE=strict

# --------------------------------------------
# DATABASE CONFIGURATION
# --------------------------------------------
# All database credentials stored in AWS Secrets Manager
DATABASE_HOST=(Retrieved from: candlefish/database/host)
DATABASE_PORT=(Retrieved from: candlefish/database/port)
DATABASE_NAME=(Retrieved from: candlefish/database/name)
DATABASE_USER=(Retrieved from: candlefish/database/username)
DATABASE_PASSWORD=(Retrieved from: candlefish/database/password)
DATABASE_SSL_MODE=require
DATABASE_MAX_CONNECTIONS=20
DATABASE_CONNECTION_TIMEOUT=10000

# --------------------------------------------
# REDIS CONFIGURATION (Session Store)
# --------------------------------------------
REDIS_HOST=(Retrieved from: candlefish/redis/host)
REDIS_PORT=(Retrieved from: candlefish/redis/port)
REDIS_PASSWORD=(Retrieved from: candlefish/redis/password)
REDIS_TLS_ENABLED=true
REDIS_DB=0
REDIS_KEY_PREFIX=candlefish:

# --------------------------------------------
# RATE LIMITING
# --------------------------------------------
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_BLOCK_DURATION=300000
RATE_LIMIT_WHITELIST=127.0.0.1,::1
ENABLE_RATE_LIMITING=true

# --------------------------------------------
# SECURITY HEADERS & CSP
# --------------------------------------------
CSP_REPORT_URI=https://api.candlefish.ai/csp-report
CSP_REPORT_ONLY=false
ENFORCE_HTTPS=true
HSTS_MAX_AGE=63072000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# --------------------------------------------
# MONITORING & LOGGING
# --------------------------------------------
LOG_LEVEL=info
ENABLE_ACCESS_LOGS=true
ENABLE_ERROR_TRACKING=true
SENTRY_DSN=(Retrieved from: candlefish/monitoring/sentry-dsn)
DATADOG_API_KEY=(Retrieved from: candlefish/monitoring/datadog-api-key)
NEW_RELIC_LICENSE_KEY=(Retrieved from: candlefish/monitoring/newrelic-key)

# --------------------------------------------
# EMAIL SERVICE
# --------------------------------------------
EMAIL_PROVIDER=sendgrid
SENDGRID_API_KEY=(Retrieved from: candlefish/email/sendgrid-api-key)
FROM_EMAIL=security@candlefish.ai
ADMIN_EMAIL=admin@candlefish.ai
NOTIFICATION_EMAIL=notifications@candlefish.ai

# --------------------------------------------
# EXTERNAL SERVICES
# --------------------------------------------
# Stripe for payments
STRIPE_SECRET_KEY=(Retrieved from: candlefish/api/stripe-secret)
STRIPE_WEBHOOK_SECRET=(Retrieved from: candlefish/api/stripe-webhook-secret)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=(Retrieved from: candlefish/api/stripe-public)

# Twilio for SMS/2FA
TWILIO_ACCOUNT_SID=(Retrieved from: candlefish/api/twilio-sid)
TWILIO_AUTH_TOKEN=(Retrieved from: candlefish/api/twilio-auth)
TWILIO_PHONE_NUMBER=(Retrieved from: candlefish/api/twilio-phone)

# --------------------------------------------
# FEATURE FLAGS
# --------------------------------------------
ENABLE_2FA=true
ENABLE_OAUTH=true
ENABLE_SSO=false
ENABLE_API_KEYS=true
ENABLE_WEBHOOK_ENDPOINTS=true
ENABLE_AUDIT_LOGS=true

# --------------------------------------------
# OAUTH PROVIDERS
# --------------------------------------------
GITHUB_CLIENT_ID=(Retrieved from: candlefish/oauth/github-client-id)
GITHUB_CLIENT_SECRET=(Retrieved from: candlefish/oauth/github-client-secret)

GOOGLE_CLIENT_ID=(Retrieved from: candlefish/oauth/google-client-id)
GOOGLE_CLIENT_SECRET=(Retrieved from: candlefish/oauth/google-client-secret)

# --------------------------------------------
# ENCRYPTION & SECURITY
# --------------------------------------------
ENCRYPTION_KEY=(Retrieved from: candlefish/encryption/master-key)
CACHE_ENCRYPTION_KEY=(Retrieved from: candlefish/encryption/cache-key)
BACKUP_ENCRYPTION_KEY=(Retrieved from: candlefish/encryption/backup-key)

# --------------------------------------------
# BACKUP & RECOVERY
# --------------------------------------------
BACKUP_S3_BUCKET=candlefish-security-backups
BACKUP_RETENTION_DAYS=30
ENABLE_AUTO_BACKUP=true
BACKUP_SCHEDULE=0 2 * * *

# --------------------------------------------
# COMPLIANCE & AUDIT
# --------------------------------------------
ENABLE_GDPR_COMPLIANCE=true
ENABLE_HIPAA_COMPLIANCE=false
ENABLE_SOC2_COMPLIANCE=true
AUDIT_LOG_RETENTION_DAYS=90
PII_ENCRYPTION_ENABLED=true

# --------------------------------------------
# DEVELOPMENT OVERRIDES (Remove in production)
# --------------------------------------------
# DISABLE_AUTH=false
# DISABLE_RATE_LIMIT=false
# DISABLE_CSP=false
# DEBUG_MODE=false

# ============================================
# SECURITY NOTES:
# 
# 1. NEVER commit actual values to version control
# 2. All sensitive values should be retrieved from AWS Secrets Manager
# 3. Use IAM roles instead of access keys when possible
# 4. Rotate all secrets regularly (monthly for critical, quarterly for others)
# 5. Enable audit logging for all secret access
# 6. Use separate secrets for each environment (dev, staging, prod)
# 7. Implement secret versioning for rollback capability
# 8. Monitor for exposed secrets in code repositories
# 
# To retrieve secrets programmatically:
# aws secretsmanager get-secret-value --secret-id "candlefish/[secret-name]"
# ============================================